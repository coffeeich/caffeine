<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Caffeine</title>
  <link rel="stylesheet" type="text/css" href="documentation/css/docs.css" />
  <link rel="stylesheet" type="text/css" href="documentation/css/pojoaque.css" />
  <link rel="shortcut icon" href="documentation/images/favicon.ico" />
</head>
<body>

  <div id="fadeout"></div>

  <div id="flybar">
    <a id="logo" href="#top"> </a>
    <div class="navigation toc">
      <div class="button">
        Table of Contents
      </div>
      <div class="contents menu">
        <a href="#overview">Overview</a>
        <a href="#installation">Installation</a>
        <a href="#nodejs">The latest versions of Node.js and npm</a>
        <a href="#usage">Usage</a>
        <a href="#language">Language Reference</a>
        <a href="#literals">Literals: Functions, Objects and Arrays</a>
        <a href="#lexical_scope">Lexical Scoping and Variable Safety</a>
        <a href="#conditionals">If, Else, Unless, and Conditional Assignment</a>
        <a href="#splats">Splats...</a>
        <a href="#loops">Loops and Comprehensions</a>
        <a href="#slices">Array Slicing and Splicing</a>
        <a href="#expressions">Everything is an Expression</a>
        <a href="#operators">Operators and Aliases</a>
        <a href="#classes">Classes, Inheritance, and Super</a>
        <a href="#destructuring">Destructuring Assignment</a>
        <a href="#fat_arrow">Function Binding</a>
        <a href="#embedded">Embedded JavaScript</a>
        <a href="#switch">Switch and Try/Catch</a>
        <a href="#comparisons">Chained Comparisons</a>
        <a href="#strings">String Interpolation, Block Strings, and Block Comments</a>
        <a href="#regexes">Block Regular Expressions</a>
        <a href="#cake">Cake, and Cakefiles</a>
        <a href="#scripts">"text/coffeescript" Script Tags</a>
        <a href="#resources">Books, Screencasts, Examples and Resources</a>
        <a href="#changelog">Change Log</a>
      </div>
    </div>
    <div class="navigation try">
      <div class="button">
        Try Caffeine
        <div class="repl_bridge"></div>
      </div>
      <div class="contents repl_wrapper">
        <div class="code">
          <div class="screenshadow tl"></div>
          <div class="screenshadow tr"></div>
          <div class="screenshadow bl"></div>
          <div class="screenshadow br"></div>
          <div id="repl_source_wrap">
            <textarea id="repl_source" rows="100" spellcheck="false">alert "More Caffeine!"</textarea>
          </div>
          <div id="repl_results_wrap"><pre id="repl_results"></pre></div>
          <div class="minibutton dark run" title="Ctrl-Enter">Run</div>
          <a class="minibutton permalink" id="repl_permalink">Link</a>
          <br class="clear" />
        </div>
      </div>
    </div>
    <div class="navigation annotated">
      <div class="button">
        Annotated Source
      </div>
      <div class="contents menu">
        <a href="documentation/docs/grammar.html">Grammar Rules &mdash; src/grammar</a>
        <a href="documentation/docs/lexer.html">Lexing Tokens &mdash; src/lexer</a>
        <a href="documentation/docs/rewriter.html">The Rewriter &mdash; src/rewriter</a>
        <a href="documentation/docs/nodes.html">The Syntax Tree &mdash; src/nodes</a>
        <a href="documentation/docs/scope.html">Lexical Scope &mdash; src/scope</a>
        <a href="documentation/docs/helpers.html">Helpers &amp; Utility Functions &mdash; src/helpers</a>
        <a href="documentation/docs/caffeine.html">The Caffeine Module &mdash; src/caffeine</a>
        <a href="documentation/docs/cake.html">Cake &amp; Cakefiles &mdash; src/cake</a>
        <a href="documentation/docs/command.html">"caffeine" Command-Line Utility &mdash; src/command</a>
        <a href="documentation/docs/optparse.html">Option Parsing &mdash; src/optparse</a>
        <a href="documentation/docs/repl.html">Interactive REPL &mdash; src/repl</a>
      </div>
    </div>
    <div id="error" style="display:none;"></div>
  </div>

  <div class="container">
    <span class="bookmark" id="top"></span>
    <p>
      <b>Caffeine is an extended <a href="http://coffeescript.org/">CoffeeScript</a> compiler.</b> It's based on CoffeeScript and adds extra functionality (e.g., packages and import). Also it <b>will</b> provide ready-to-use classes of <b><i>Caffeine API</i></b>.
    </p>
    <p>
      The golden rule of Caffeine: <i>"It's just CoffeeScript"</i>.
    </p>
    <p>
      The Promise: Caffeine will always be up-to-date to the latest version
      of CoffeeScript and will never implement any ugly syntax. </p>
    <p>
      <b>Latest Version:</b>
      <a href="http://github.com/ich/caffeine/tarball/0.2.4">0.2.4</a>
    </p>

    <h2>
      <span id="overview" class="bookmark"></span>
      Overview
    </h2>

    <p><i>CoffeeScript on the left, compiled JavaScript output on the right.</i></p>

    <div class='code'><pre><code class="coffeescript"><span class="comment"># Assignment:</span>
number   = <span class="number">42</span>
opposite = <span class="literal">true</span>

<span class="comment"># Conditions:</span>
number = -<span class="number">42</span> <span class="keyword">if</span> opposite

<span class="comment"># Functions:</span>
<span class="function"><span class="title">square</span></span> = (x) -> x * x

<span class="comment"># Arrays:</span>
list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]

<span class="comment"># Objects:</span>
math =
  root:   Math.sqrt
  square: square
  cube:   (x) -> x * square x

<span class="comment"># Splats:</span>
<span class="function"><span class="title">race</span></span> = (winner, runners...) ->
  print winner, runners

<span class="comment"># Existence:</span>
alert <span class="string">"I knew it!"</span> <span class="keyword">if</span> elvis?

<span class="comment"># Array comprehensions:</span>
cubes = (math.cube num <span class="keyword">for</span> num <span class="keyword">in</span> list)</code></pre><pre><code class="javascript"><span class="keyword">var</span> cubes, list, math, num, number, opposite, race, square,
  __slice = [].slice;

number = <span class="number">42</span>;

opposite = <span class="literal">true</span>;

<span class="keyword">if</span> (opposite) {
  number = -<span class="number">42</span>;
}

square = <span class="keyword">function</span>(x) {
  <span class="keyword">return</span> x * x;
};

list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];

math = {
  root: Math.sqrt,
  square: square,
  cube: <span class="keyword">function</span>(x) {
    <span class="keyword">return</span> x * square(x);
  }
};

race = <span class="keyword">function</span>() {
  <span class="keyword">var</span> runners, winner;
  winner = arguments[<span class="number">0</span>], runners = <span class="number">2</span> &lt;= arguments.length ? __slice.call(arguments, <span class="number">1</span>) : [];
  <span class="keyword">return</span> print(winner, runners);
};

<span class="keyword">if</span> (<span class="keyword">typeof</span> elvis !== <span class="string">"undefined"</span> &amp;&amp; elvis !== <span class="literal">null</span>) {
  alert(<span class="string">"I knew it!"</span>);
}

cubes = (<span class="keyword">function</span>() {
  <span class="keyword">var</span> _i, _len, _results;
  _results = [];
  <span class="keyword">for</span> (_i = <span class="number">0</span>, _len = list.length; _i &lt; _len; _i++) {
    num = list[_i];
    _results.push(math.cube(num));
  }
  <span class="keyword">return</span> _results;
})();</code></pre><script>window.example1 = "# Assignment:\nnumber   = 42\nopposite = true\n\n# Conditions:\nnumber = -42 if opposite\n\n# Functions:\nsquare = (x) -> x * x\n\n# Arrays:\nlist = [1, 2, 3, 4, 5]\n\n# Objects:\nmath =\n  root:   Math.sqrt\n  square: square\n  cube:   (x) -> x * square x\n\n# Splats:\nrace = (winner, runners...) ->\n  print winner, runners\n\n# Existence:\nalert \"I knew it!\" if elvis?\n\n# Array comprehensions:\ncubes = (math.cube num for num in list)\n\nalert cubes"</script><div class='minibutton ok' onclick='var cubes, list, math, num, number, opposite, race, square,
  __slice = [].slice;

number = 42;

opposite = true;

if (opposite) {
  number = -42;
}

square = function(x) {
  return x * x;
};

list = [1, 2, 3, 4, 5];

math = {
  root: Math.sqrt,
  square: square,
  cube: function(x) {
    return x * square(x);
  }
};

race = function() {
  var runners, winner;
  winner = arguments[0], runners = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
  return print(winner, runners);
};

if (typeof elvis !== "undefined" && elvis !== null) {
  alert("I knew it!");
}

cubes = (function() {
  var _i, _len, _results;
  _results = [];
  for (_i = 0, _len = list.length; _i < _len; _i++) {
    num = list[_i];
    _results.push(math.cube(num));
  }
  return _results;
})();;alert(cubes);'>run: cubes</div><br class='clear' /></div>

    <h2>
      <span id="installation" class="bookmark"></span>
      Installation
    </h2>

    <p>
      The Caffeine compiler is itself
      <a href="documentation/docs/grammar.html">written in CoffeeScript</a>,
      using the <a href="http://jison.org">Jison parser generator</a>. The
      command-line version of <tt>caffeine</tt> is available as a
      <a href="http://nodejs.org/">Node.js</a> utility. The
      <a href="extras/caffeine.js">core compiler</a> however, does not
      depend on Node, and can be run in any JavaScript environment, or in the
      browser (see "Try Caffeine", above).
    </p>

    <p>
      To install, first make sure you have a working copy of <a href="#nodejs">the latest stable version</a>  of
      <a href="http://nodejs.org/">Node.js</a>, and <a href="http://npmjs.org/">npm</a>
      (the Node Package Manager). You can then install Caffeine with npm:
    </p>

    <pre>npm install -g caffeine</pre>

    <p>
      (Leave off the <tt>-g</tt> if you don't wish to install globally.)
    </p>

    <p>
      If you'd prefer to install the latest master version of Caffeine, you
      can clone the Caffeine <a href="http://github.com/ich/caffeine">source repository</a>
      from GitHub, or download <a href="http://github.com/ich/caffeine/tarball/master">the source</a> directly.
      To install the Caffeine compiler system-wide
      under <tt>/usr/local</tt>, open the directory and run:
    </p>

    <pre>sudo bin/cake install</pre>

    <h2>
      <span id="nodejs" class="bookmark"></span>

      The latest versions of Node.js and npm
    </h2>

    <p>
      Install latest stable version of Node.js on Ubuntu:
    </p>
    <pre>sudo apt-get install python-software-properties
sudo add-apt-repository ppa:chris-lea/node.js
sudo apt-get update
sudo apt-get install nodejs</pre>
    <p><a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">See</a> how to install latest stable version of Node.js on other systems.</p>
    <p>
      Install latest stable version of NMP from ppa:chris-lea/node.js repository:
    </p>
    <pre>sudo apt-get install npm</pre>

    <p>As you guess there is another way and it's described on npm home page:</p>
    <pre>curl http://npmjs.org/install.sh | sh</pre>

    <h2>
      <span id="usage" class="bookmark"></span>
      Usage
    </h2>

    <p>
      Once installed, you should have access to the <tt>caffeine</tt> command,
      which can execute scripts, compile <tt>.coffee</tt> files into <tt>.js</tt>,
      and provide an interactive REPL. The <tt>caffeine</tt> command takes the
      following options:
    </p>

    <table>
      <tr>
        <td><code>-c, --compile</code></td>
        <td>
          Compile a <tt>.coffee</tt> script into a <tt>.js</tt> JavaScript file
          of the same name.
        </td>
      </tr>
      <tr>
        <td width="25%"><code>-i, --interactive</code></td>
        <td>
          Launch an interactive Caffeine session to try short snippets.
          Identical to calling <tt>caffeine</tt> with no arguments.
        </td>
      </tr>
      <tr>
        <td><code>-o, --output [DIR]</code></td>
        <td>
          Write out all compiled JavaScript files into the specified directory.
          Use in conjunction with <tt>--compile</tt> or <tt>--watch</tt>.
        </td>
      </tr>
      <tr>
        <td><code>-j, --join [FILE]</code></td>
        <td>
          Before compiling, concatenate all scripts together in the order they
          were passed, and write them into the specified file.
          Useful for building large projects.
        </td>
      </tr>
      <tr>
        <td><code>-w, --watch</code></td>
        <td>
          Watch files for changes, rerunning the specified command when any
          file is updated.
        </td>
      </tr>
      <tr>
        <td><code>-p, --print</code></td>
        <td>
          Instead of writing out the JavaScript as a file, print it
          directly to <b>stdout</b>.
        </td>
      </tr>
      <tr>
        <td><code>-l, --lint</code></td>
        <td>
          If the <tt>jsl</tt>
          (<a href="http://www.javascriptlint.com/">JavaScript Lint</a>)
          command is installed, use it
          to check the compilation of a CoffeeScript file. (Handy in
          conjunction with <br /> <tt>--watch</tt>)
        </td>
      </tr>
      <tr>
        <td><code>-s, --stdio</code></td>
        <td>
          Pipe in CoffeeScript to STDIN and get back JavaScript over STDOUT.
          Good for use with processes written in other languages. An example:<br />
          <tt>cat src/cake.coffee | caffeine -sc</tt>
        </td>
      </tr>
      <tr>
        <td><code>-e, --eval</code></td>
        <td>
          Compile and print a little snippet of CoffeeScript directly from the
          command line. For example:<br /><tt>caffeine -e "console.log num for num in [10..1]"</tt>
        </td>
      </tr>
      <tr>
        <td><code>-r, --require</code></td>
        <td>
          Load a library before compiling or executing your script. Can be used
          to hook in to the compiler (to add Growl notifications, for example).
        </td>
      </tr>
      <tr>
        <td><code>-b, --bare</code></td>
        <td>
          Compile the JavaScript without the 
          <a href="#lexical_scope">top-level function safety wrapper</a>.
        </td>
      </tr>
      <tr>
        <td><code>-t, --tokens</code></td>
        <td>
          Instead of parsing the CoffeeScript, just lex it, and print out the
          token stream: <tt>[IDENTIFIER square] [ASSIGN =] [PARAM_START (]</tt> ...
        </td>
      </tr>
      <tr>
        <td><code>-n, --nodes</code></td>
        <td>
          Instead of compiling the CoffeeScript, just lex and parse it, and print
          out the parse tree:
<pre class="no_bar">
Expressions
  Assign
    Value "square"
    Code "x"
      Op *
        Value "x"
        Value "x"</pre>
        </td>
      </tr>
      <tr>
        <td><code>--nodejs</code></td>
        <td>
          The <tt>node</tt> executable has some useful options you can set,
          such as<br /> <tt>--debug</tt>, <tt>--debug-brk</tt> and <tt>--max-stack-size</tt>. Use this
          flag to forward options directly to Node.js.
        </td>
      </tr>
    </table>

    <p>
      <b>Examples:</b>
    </p>

    <ul>
      <li>
        Compile a directory tree of <tt>.coffee</tt> files in <tt>src</tt> into a parallel
        tree of <tt>.js</tt> files in <tt>lib</tt>:<br />
        <tt>caffeine --compile --output lib/ src/</tt>
      </li>
      <li>
        Watch a file for changes, and recompile it every time the file is saved:<br />
        <tt>caffeine --watch --compile experimental.coffee</tt>
      </li>
      <li>
        Concatenate a list of files into a single script:<br />
        <tt>caffeine --join project.js --compile src/*.coffee</tt>
      </li>
      <li>
        Print out the compiled JS from a one-liner:<br />
        <tt>caffeine -bpe "alert i for i in [0..10]"</tt>
      </li>
      <li>
        All together now, watch and recompile an entire project as you work on it:<br />
        <tt>caffeine -o lib/ -cw src/</tt>
      </li>
      <li>
        Start the Caffeine REPL (<tt>Ctrl-D</tt> to exit, <tt>Ctrl-V</tt>for multi-line):<br />
        <tt>caffeine</tt>
      </li>
    </ul>

    <h2>
      <span id="language" class="bookmark"></span>
      Language Reference
    </h2>

    <p>
      <i>
        Basic CoffeeScript reference is available <a href="http://coffeescript.org/">CoffeeScript home page</a>.
        
      </i>
    </p>

    <p>
      <i>
        This reference is structured so that it can be read from top to bottom,
        if you like. Later sections use ideas and syntax previously introduced.
        Familiarity with JavaScript is assumed.
        In all of the following examples, the source CoffeeScript is provided on
        the left, and the direct compilation into JavaScript is on the right.
      </i>
    </p>

    <p>
      <i>
        Many of the examples can be run (where it makes sense) by pressing the <b>run</b>
        button on the right, and can be loaded into the "Try Caffeine"
        console by pressing the <b>load</b> button on the left.
      </i>
    <p>
      First, the basics: CoffeeScript uses significant whitespace to delimit blocks of code.
      You don't need to use semicolons <tt>;</tt> to terminate expressions,
      ending the line will do just as well (although semicolons can still
      be used to fit multiple expressions onto a single line).
      Instead of using curly braces
      <tt>{ }</tt> to surround blocks of code in <a href="#literals">functions</a>,
      <a href="#conditionals">if-statements</a>,
      <a href="#switch">switch</a>, and <a href="#try">try/catch</a>,
      use indentation.
    </p>

    <p>
      You don't need to use parentheses to invoke a function if you're passing
      arguments. The implicit call wraps forward to the end of the line or block expression.<br />
      <tt>console.log sys.inspect object</tt> &rarr; <tt>console.log(sys.inspect(object));</tt>
    </p>

    <p>
      <span id="literals" class="bookmark"></span>
      <b class="header">Functions</b>
      Functions are defined by an optional list of parameters in parentheses,
      an arrow, and the function body. The empty function looks like this:
      <tt>-></tt>
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="function"><span class="title">square</span></span> = (x) -> x * x
<span class="function"><span class="title">cube</span></span>   = (x) -> square(x) * x</code></pre><pre><code class="javascript"><span class="keyword">var</span> cube, square;

square = <span class="keyword">function</span>(x) {
  <span class="keyword">return</span> x * x;
};

cube = <span class="keyword">function</span>(x) {
  <span class="keyword">return</span> square(x) * x;
};</code></pre><script>window.example2 = "square = (x) -> x * x\ncube   = (x) -> square(x) * x\n\nalert cube(5)"</script><div class='minibutton ok' onclick='var cube, square;

square = function(x) {
  return x * x;
};

cube = function(x) {
  return square(x) * x;
};;alert(cube(5));'>run: cube(5)</div><br class='clear' /></div>
    <p>
      Functions may also have default values for arguments. Override the default
      value by passing a non-null argument.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="function"><span class="title">fill</span></span> = (container, liquid = <span class="string">"coffee"</span>) ->
  <span class="string">"Filling the <span class="subst">#{container}</span> with <span class="subst">#{liquid}</span>..."</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> fill;

fill = <span class="keyword">function</span>(container, liquid) {
  <span class="keyword">if</span> (liquid == <span class="literal">null</span>) {
    liquid = <span class="string">"coffee"</span>;
  }
  <span class="keyword">return</span> <span class="string">"Filling the "</span> + container + <span class="string">" with "</span> + liquid + <span class="string">"..."</span>;
};</code></pre><script>window.example3 = "fill = (container, liquid = \"coffee\") ->\n  \"Filling the #{container} with #{liquid}...\"\n\nalert fill(\"cup\")"</script><div class='minibutton ok' onclick='var fill;

fill = function(container, liquid) {
  if (liquid == null) {
    liquid = "coffee";
  }
  return "Filling the " + container + " with " + liquid + "...";
};;alert(fill("cup"));'>run: fill("cup")</div><br class='clear' /></div>

    <p>
      <span id="objects_and_arrays" class="bookmark"></span>
      <b class="header">Objects and Arrays</b>
      The CoffeeScript literals for objects and arrays look very similar to
      their JavaScript cousins. When each property is listed on its own line,
      the commas are optional. Objects may be created using indentation instead
      of explicit braces, similar to <a href="http://yaml.org">YAML</a>.
    </p>
    <div class='code'><pre><code class="coffeescript">song = [<span class="string">"do"</span>, <span class="string">"re"</span>, <span class="string">"mi"</span>, <span class="string">"fa"</span>, <span class="string">"so"</span>]

singers = {Jagger: <span class="string">"Rock"</span>, Elvis: <span class="string">"Roll"</span>}

bitlist = [
  <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>
  <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>
  <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>
]

kids =
  brother:
    name: <span class="string">"Max"</span>
    age:  <span class="number">11</span>
  sister:
    name: <span class="string">"Ida"</span>
    age:  <span class="number">9</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> bitlist, kids, singers, song;

song = [<span class="string">"do"</span>, <span class="string">"re"</span>, <span class="string">"mi"</span>, <span class="string">"fa"</span>, <span class="string">"so"</span>];

singers = {
  Jagger: <span class="string">"Rock"</span>,
  Elvis: <span class="string">"Roll"</span>
};

bitlist = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>];

kids = {
  brother: {
    name: <span class="string">"Max"</span>,
    age: <span class="number">11</span>
  },
  sister: {
    name: <span class="string">"Ida"</span>,
    age: <span class="number">9</span>
  }
};</code></pre><script>window.example4 = "song = [\"do\", \"re\", \"mi\", \"fa\", \"so\"]\n\nsingers = {Jagger: \"Rock\", Elvis: \"Roll\"}\n\nbitlist = [\n  1, 0, 1\n  0, 0, 1\n  1, 1, 0\n]\n\nkids =\n  brother:\n    name: \"Max\"\n    age:  11\n  sister:\n    name: \"Ida\"\n    age:  9\n\nalert song.join(\" ... \")"</script><div class='minibutton ok' onclick='var bitlist, kids, singers, song;

song = ["do", "re", "mi", "fa", "so"];

singers = {
  Jagger: "Rock",
  Elvis: "Roll"
};

bitlist = [1, 0, 1, 0, 0, 1, 1, 1, 0];

kids = {
  brother: {
    name: "Max",
    age: 11
  },
  sister: {
    name: "Ida",
    age: 9
  }
};;alert(song.join(" ... "));'>run: song.join(" ... ")</div><br class='clear' /></div>
    <p>
      In JavaScript, you can't use reserved words, like <tt>class</tt>, as properties
      of an object, without quoting them as strings. CoffeeScript notices reserved words
      used as keys in objects and quotes them for you, so you don't have to worry
      about it (say, when using jQuery).
    </p>
    <div class='code'><pre><code class="coffeescript">$(<span class="string">'.account'</span>).attr <span class="keyword">class</span>: <span class="string">'active'</span>

log object.<span class="keyword">class</span></code></pre><pre><code class="javascript">$(<span class="string">'.account'</span>).attr({
  <span class="string">"class"</span>: <span class="string">'active'</span>
});

log(object[<span class="string">"class"</span>]);</code></pre><script>window.example5 = "$('.account').attr class: 'active'\n\nlog object.class"</script><br class='clear' /></div>

    <p>
      <span id="lexical_scope" class="bookmark"></span>
      <b class="header">Lexical Scoping and Variable Safety</b>
      The CoffeeScript compiler takes care to make sure that all of your variables
      are properly declared within lexical scope &mdash; you never need to write
      <tt>var</tt> yourself.
    </p>
    <div class='code'><pre><code class="coffeescript">outer = <span class="number">1</span>
<span class="function"><span class="title">changeNumbers</span></span> = ->
  inner = -<span class="number">1</span>
  outer = <span class="number">10</span>
inner = changeNumbers()</code></pre><pre><code class="javascript"><span class="keyword">var</span> changeNumbers, inner, outer;

outer = <span class="number">1</span>;

changeNumbers = <span class="keyword">function</span>() {
  <span class="keyword">var</span> inner;
  inner = -<span class="number">1</span>;
  <span class="keyword">return</span> outer = <span class="number">10</span>;
};

inner = changeNumbers();</code></pre><script>window.example6 = "outer = 1\nchangeNumbers = ->\n  inner = -1\n  outer = 10\ninner = changeNumbers()\n\nalert inner"</script><div class='minibutton ok' onclick='var changeNumbers, inner, outer;

outer = 1;

changeNumbers = function() {
  var inner;
  inner = -1;
  return outer = 10;
};

inner = changeNumbers();;alert(inner);'>run: inner</div><br class='clear' /></div>
    <p>
      Notice how all of the variable declarations have been pushed up to
      the top of the closest scope, the first time they appear.
      <b>outer</b> is not redeclared within the inner function, because it's
      already in scope; <b>inner</b> within the function, on the other hand,
      should not be able to change the value of the external variable of the same name, and
      therefore has a declaration of its own.
    </p>
    <p>
      This behavior is effectively identical to Ruby's scope for local variables.
      Because you don't have direct access to the <tt>var</tt> keyword,
      it's impossible to shadow an outer variable on purpose, you may only refer
      to it. So be careful that you're not reusing the name of an external
      variable accidentally, if you're writing a deeply nested function.
    </p>
    <p>
      Although suppressed within this documentation for clarity, all
      CoffeeScript output is wrapped in an anonymous function:
      <tt>(function(){ ... })();</tt> This safety wrapper, combined with the
      automatic generation of the <tt>var</tt> keyword, make it exceedingly difficult
      to pollute the global namespace by accident.
    </p>
    <p>
      If you'd like to create top-level variables for other scripts to use,
      attach them as properties on <b>window</b>, or on the <b>exports</b>
      object in CommonJS. The <b>existential operator</b> (covered below), gives you a
      reliable way to figure out where to add them; if you're targeting both
      CommonJS and the browser: <tt>exports ? this</tt>
    </p>

    <p>
      <span id="conditionals" class="bookmark"></span>
      <b class="header">If, Else, Unless, and Conditional Assignment</b>
      <b>If/else</b> statements can be written without the use of parentheses and
      curly brackets. As with functions and other block expressions,
      multi-line conditionals are delimited by indentation. There's also a handy
      postfix form, with the <tt>if</tt> or <tt>unless</tt> at the end.
    </p>
    <p>
      CoffeeScript can compile <b>if</b> statements into JavaScript expressions,
      using the ternary operator when possible, and closure wrapping otherwise. There
      is no explicit ternary statement in CoffeeScript &mdash; you simply use
      a regular <b>if</b> statement on a single line.
    </p>
    <div class='code'><pre><code class="coffeescript">mood = greatlyImproved <span class="keyword">if</span> singing

<span class="keyword">if</span> happy <span class="keyword">and</span> knowsIt
  clapsHands()
  chaChaCha()
<span class="keyword">else</span>
  showIt()

date = <span class="keyword">if</span> friday then sue <span class="keyword">else</span> jill</code></pre><pre><code class="javascript"><span class="keyword">var</span> date, mood;

<span class="keyword">if</span> (singing) {
  mood = greatlyImproved;
}

<span class="keyword">if</span> (happy &amp;&amp; knowsIt) {
  clapsHands();
  chaChaCha();
} <span class="keyword">else</span> {
  showIt();
}

date = friday ? sue : jill;</code></pre><script>window.example7 = "mood = greatlyImproved if singing\n\nif happy and knowsIt\n  clapsHands()\n  chaChaCha()\nelse\n  showIt()\n\ndate = if friday then sue else jill"</script><br class='clear' /></div>

    <p>
      <span id="splats" class="bookmark"></span>
      <b class="header">Splats...</b>
      The JavaScript <b>arguments object</b> is a useful way to work with
      functions that accept variable numbers of arguments. CoffeeScript provides
      splats <tt>...</tt>, both for function definition as well as invocation,
      making variable numbers of arguments a little bit more palatable.
    </p>
    <div class='code'><pre><code class="coffeescript">gold = silver = rest = <span class="string">"unknown"</span>

<span class="function"><span class="title">awardMedals</span></span> = (first, second, others...) ->
  gold   = first
  silver = second
  rest   = others

contenders = [
  <span class="string">"Michael Phelps"</span>
  <span class="string">"Liu Xiang"</span>
  <span class="string">"Yao Ming"</span>
  <span class="string">"Allyson Felix"</span>
  <span class="string">"Shawn Johnson"</span>
  <span class="string">"Roman Sebrle"</span>
  <span class="string">"Guo Jingjing"</span>
  <span class="string">"Tyson Gay"</span>
  <span class="string">"Asafa Powell"</span>
  <span class="string">"Usain Bolt"</span>
]

awardMedals contenders...

alert <span class="string">"Gold: "</span> + gold
alert <span class="string">"Silver: "</span> + silver
alert <span class="string">"The Field: "</span> + rest</code></pre><pre><code class="javascript"><span class="keyword">var</span> awardMedals, contenders, gold, rest, silver,
  __slice = [].slice;

gold = silver = rest = <span class="string">"unknown"</span>;

awardMedals = <span class="keyword">function</span>() {
  <span class="keyword">var</span> first, others, second;
  first = arguments[<span class="number">0</span>], second = arguments[<span class="number">1</span>], others = <span class="number">3</span> &lt;= arguments.length ? __slice.call(arguments, <span class="number">2</span>) : [];
  gold = first;
  silver = second;
  <span class="keyword">return</span> rest = others;
};

contenders = [<span class="string">"Michael Phelps"</span>, <span class="string">"Liu Xiang"</span>, <span class="string">"Yao Ming"</span>, <span class="string">"Allyson Felix"</span>, <span class="string">"Shawn Johnson"</span>, <span class="string">"Roman Sebrle"</span>, <span class="string">"Guo Jingjing"</span>, <span class="string">"Tyson Gay"</span>, <span class="string">"Asafa Powell"</span>, <span class="string">"Usain Bolt"</span>];

awardMedals.apply(<span class="literal">null</span>, contenders);

alert(<span class="string">"Gold: "</span> + gold);

alert(<span class="string">"Silver: "</span> + silver);

alert(<span class="string">"The Field: "</span> + rest);</code></pre><script>window.example8 = "gold = silver = rest = \"unknown\"\n\nawardMedals = (first, second, others...) ->\n  gold   = first\n  silver = second\n  rest   = others\n\ncontenders = [\n  \"Michael Phelps\"\n  \"Liu Xiang\"\n  \"Yao Ming\"\n  \"Allyson Felix\"\n  \"Shawn Johnson\"\n  \"Roman Sebrle\"\n  \"Guo Jingjing\"\n  \"Tyson Gay\"\n  \"Asafa Powell\"\n  \"Usain Bolt\"\n]\n\nawardMedals contenders...\n\nalert \"Gold: \" + gold\nalert \"Silver: \" + silver\nalert \"The Field: \" + rest"</script><div class='minibutton ok' onclick='var awardMedals, contenders, gold, rest, silver,
  __slice = [].slice;

gold = silver = rest = "unknown";

awardMedals = function() {
  var first, others, second;
  first = arguments[0], second = arguments[1], others = 3 <= arguments.length ? __slice.call(arguments, 2) : [];
  gold = first;
  silver = second;
  return rest = others;
};

contenders = ["Michael Phelps", "Liu Xiang", "Yao Ming", "Allyson Felix", "Shawn Johnson", "Roman Sebrle", "Guo Jingjing", "Tyson Gay", "Asafa Powell", "Usain Bolt"];

awardMedals.apply(null, contenders);

alert("Gold: " + gold);

alert("Silver: " + silver);

alert("The Field: " + rest);;'>run</div><br class='clear' /></div>

    <p>
      <span id="loops" class="bookmark"></span>
      <b class="header">Loops and Comprehensions</b>
      Most of the loops you'll write in CoffeeScript will be <b>comprehensions</b>
      over arrays, objects, and ranges. Comprehensions replace (and compile into)
      <b>for</b> loops, with optional guard clauses and the value of the current array index.
      Unlike for loops, array comprehensions are expressions, and can be returned
      and assigned.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="comment"># Eat lunch.</span>
eat food <span class="keyword">for</span> food <span class="keyword">in</span> [<span class="string">'toast'</span>, <span class="string">'cheese'</span>, <span class="string">'wine'</span>]

<span class="comment"># Fine five course dining.</span>
courses = [<span class="string">'greens'</span>, <span class="string">'caviar'</span>, <span class="string">'truffles'</span>, <span class="string">'roast'</span>, <span class="string">'cake'</span>]
menu i + <span class="number">1</span>, dish <span class="keyword">for</span> dish, i <span class="keyword">in</span> courses

<span class="comment"># Health conscious meal.</span>
foods = [<span class="string">'broccoli'</span>, <span class="string">'spinach'</span>, <span class="string">'chocolate'</span>]
eat food <span class="keyword">for</span> food <span class="keyword">in</span> foods <span class="keyword">when</span> food <span class="keyword">isnt</span> <span class="string">'chocolate'</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> courses, dish, food, foods, i, _i, _j, _k, _len, _len1, _len2, _ref;

_ref = [<span class="string">'toast'</span>, <span class="string">'cheese'</span>, <span class="string">'wine'</span>];
<span class="keyword">for</span> (_i = <span class="number">0</span>, _len = _ref.length; _i &lt; _len; _i++) {
  food = _ref[_i];
  eat(food);
}

courses = [<span class="string">'greens'</span>, <span class="string">'caviar'</span>, <span class="string">'truffles'</span>, <span class="string">'roast'</span>, <span class="string">'cake'</span>];

<span class="keyword">for</span> (i = _j = <span class="number">0</span>, _len1 = courses.length; _j &lt; _len1; i = ++_j) {
  dish = courses[i];
  menu(i + <span class="number">1</span>, dish);
}

foods = [<span class="string">'broccoli'</span>, <span class="string">'spinach'</span>, <span class="string">'chocolate'</span>];

<span class="keyword">for</span> (_k = <span class="number">0</span>, _len2 = foods.length; _k &lt; _len2; _k++) {
  food = foods[_k];
  <span class="keyword">if</span> (food !== <span class="string">'chocolate'</span>) {
    eat(food);
  }
}</code></pre><script>window.example9 = "# Eat lunch.\neat food for food in ['toast', 'cheese', 'wine']\n\n# Fine five course dining.\ncourses = ['greens', 'caviar', 'truffles', 'roast', 'cake']\nmenu i + 1, dish for dish, i in courses\n\n# Health conscious meal.\nfoods = ['broccoli', 'spinach', 'chocolate']\neat food for food in foods when food isnt 'chocolate'"</script><br class='clear' /></div>
    <p>
      Comprehensions should be able to handle most places where you otherwise
      would use a loop, <b>each</b>/<b>forEach</b>, <b>map</b>, or <b>select</b>/<b>filter</b>, for example:
      <tt>shortNames = (name for name in list when name.length &lt; 5)</tt><br />
      If you know the start and end of your loop, or would like to step through
      in fixed-size increments, you can use a range to specify the start and
      end of your comprehension.
    </p>
    <div class='code'><pre><code class="coffeescript">countdown = (num <span class="keyword">for</span> num <span class="keyword">in</span> [<span class="number">10.</span>.<span class="number">1</span>])</code></pre><pre><code class="javascript"><span class="keyword">var</span> countdown, num;

countdown = (<span class="keyword">function</span>() {
  <span class="keyword">var</span> _i, _results;
  _results = [];
  <span class="keyword">for</span> (num = _i = <span class="number">10</span>; _i >= <span class="number">1</span>; num = --_i) {
    _results.push(num);
  }
  <span class="keyword">return</span> _results;
})();</code></pre><script>window.example10 = "countdown = (num for num in [10..1])\n\nalert countdown"</script><div class='minibutton ok' onclick='var countdown, num;

countdown = (function() {
  var _i, _results;
  _results = [];
  for (num = _i = 10; _i >= 1; num = --_i) {
    _results.push(num);
  }
  return _results;
})();;alert(countdown);'>run: countdown</div><br class='clear' /></div>
    <p>
      Note how because we are assigning the value of the comprehensions to a
      variable in the example above, CoffeeScript is collecting the result of
      each iteration into an array. Sometimes functions end with loops that are
      intended to run only for their side-effects. Be careful that you're not
      accidentally returning the results of the comprehension in these cases,
      by adding a meaningful return value &mdash; like <tt>true</tt> &mdash; or <tt>null</tt>,
      to the bottom of your function.
    </p>
    <p>
      To step through a range comprehension in fixed-size chunks,
      use <tt>by</tt>, for example:<br />
      <tt>evens = (x for x in [0..10] by 2)</tt>
    </p>
    <p>
      Comprehensions can also be used to iterate over the keys and values in
      an object. Use <tt>of</tt> to signal comprehension over the properties of
      an object instead of the values in an array.
    </p>
    <div class='code'><pre><code class="coffeescript">yearsOld = max: <span class="number">10</span>, ida: <span class="number">9</span>, tim: <span class="number">11</span>

ages = <span class="keyword">for</span> child, age <span class="keyword">of</span> yearsOld
  <span class="string">"<span class="subst">#{child}</span> is <span class="subst">#{age}</span>"</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> age, ages, child, yearsOld;

yearsOld = {
  max: <span class="number">10</span>,
  ida: <span class="number">9</span>,
  tim: <span class="number">11</span>
};

ages = (<span class="keyword">function</span>() {
  <span class="keyword">var</span> _results;
  _results = [];
  <span class="keyword">for</span> (child <span class="keyword">in</span> yearsOld) {
    age = yearsOld[child];
    _results.push(<span class="string">""</span> + child + <span class="string">" is "</span> + age);
  }
  <span class="keyword">return</span> _results;
})();</code></pre><script>window.example11 = "yearsOld = max: 10, ida: 9, tim: 11\n\nages = for child, age of yearsOld\n  \"#{child} is #{age}\"\n\nalert ages.join(\", \")"</script><div class='minibutton ok' onclick='var age, ages, child, yearsOld;

yearsOld = {
  max: 10,
  ida: 9,
  tim: 11
};

ages = (function() {
  var _results;
  _results = [];
  for (child in yearsOld) {
    age = yearsOld[child];
    _results.push("" + child + " is " + age);
  }
  return _results;
})();;alert(ages.join(", "));'>run: ages.join(", ")</div><br class='clear' /></div>
    <p>
      If you would like to iterate over just the keys that are defined on the
      object itself, by adding a <tt>hasOwnProperty</tt>
      check to avoid properties that may be inherited from the prototype, use<br />
      <tt>for own key, value of object</tt>
    </p>
    <p>
      The only low-level loop that CoffeeScript provides is the <b>while</b> loop. The
      main difference from JavaScript is that the <b>while</b> loop can be used
      as an expression, returning an array containing the result of each iteration
      through the loop.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="comment"># Econ 101</span>
<span class="keyword">if</span> <span class="keyword">this</span>.studyingEconomics
  buy()  <span class="keyword">while</span> supply > demand
  sell() <span class="keyword">until</span> supply > demand

<span class="comment"># Nursery Rhyme</span>
num = <span class="number">6</span>
lyrics = <span class="keyword">while</span> num -= <span class="number">1</span>
  <span class="string">"<span class="subst">#{num}</span> little monkeys, jumping on the bed.
    One fell out and bumped his head."</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> lyrics, num;

<span class="keyword">if</span> (<span class="keyword">this</span>.studyingEconomics) {
  <span class="keyword">while</span> (supply > demand) {
    buy();
  }
  <span class="keyword">while</span> (!(supply > demand)) {
    sell();
  }
}

num = <span class="number">6</span>;

lyrics = (<span class="keyword">function</span>() {
  <span class="keyword">var</span> _results;
  _results = [];
  <span class="keyword">while</span> (num -= <span class="number">1</span>) {
    _results.push(<span class="string">""</span> + num + <span class="string">" little monkeys, jumping on the bed.    One fell out and bumped his head."</span>);
  }
  <span class="keyword">return</span> _results;
})();</code></pre><script>window.example12 = "# Econ 101\nif this.studyingEconomics\n  buy()  while supply > demand\n  sell() until supply > demand\n\n# Nursery Rhyme\nnum = 6\nlyrics = while num -= 1\n  \"#{num} little monkeys, jumping on the bed.\n    One fell out and bumped his head.\"\n\nalert lyrics.join(\"\n\")"</script><div class='minibutton ok' onclick='var lyrics, num;

if (this.studyingEconomics) {
  while (supply > demand) {
    buy();
  }
  while (!(supply > demand)) {
    sell();
  }
}

num = 6;

lyrics = (function() {
  var _results;
  _results = [];
  while (num -= 1) {
    _results.push("" + num + " little monkeys, jumping on the bed.    One fell out and bumped his head.");
  }
  return _results;
})();;alert(lyrics.join("
"));'>run: lyrics.join("
")</div><br class='clear' /></div>
    <p>
      For readability, the <b>until</b> keyword is equivalent to <tt>while not</tt>,
      and the <b>loop</b> keyword is equivalent to <tt>while true</tt>.
    </p>
    <p>
      When using a JavaScript loop to generate functions, it's common to insert
      a closure wrapper in order to ensure that loop variables are closed over,
      and all the generated functions don't just share the final values. CoffeeScript
      provides the <tt>do</tt> keyword, which immediately invokes a passed function,
      forwarding any arguments.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="keyword">for</span> filename <span class="keyword">in</span> list
  <span class="keyword">do</span> (filename) ->
    fs.readFile filename, (err, contents) ->
      compile filename, contents.toString()</code></pre><pre><code class="javascript"><span class="keyword">var</span> filename, _fn, _i, _len;

_fn = <span class="keyword">function</span>(filename) {
  <span class="keyword">return</span> fs.readFile(filename, <span class="keyword">function</span>(err, contents) {
    <span class="keyword">return</span> compile(filename, contents.toString());
  });
};
<span class="keyword">for</span> (_i = <span class="number">0</span>, _len = list.length; _i &lt; _len; _i++) {
  filename = list[_i];
  _fn(filename);
}</code></pre><script>window.example13 = "for filename in list\n  do (filename) ->\n    fs.readFile filename, (err, contents) ->\n      compile filename, contents.toString()"</script><br class='clear' /></div>

    <p>
      <span id="slices" class="bookmark"></span>
      <b class="header">Array Slicing and Splicing with Ranges</b>
      Ranges can also be used to extract slices of arrays.
      With two dots (<tt>3..6</tt>), the range is inclusive (<tt>3, 4, 5, 6</tt>);
      with three dots (<tt>3...6</tt>), the range excludes the end (<tt>3, 4, 5</tt>).
      Slices indices have useful defaults. An omitted first index defaults to
      zero and an omitted second index defaults to the size of the array.
    </p>
    <div class='code'><pre><code class="coffeescript">numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]

start   = numbers[<span class="number">0.</span>.<span class="number">2</span>]

middle  = numbers[<span class="number">3.</span>..<span class="number">6</span>]

end     = numbers[<span class="number">6.</span>.]

copy    = numbers[..]</code></pre><pre><code class="javascript"><span class="keyword">var</span> copy, end, middle, numbers, start;

numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];

start = numbers.slice(<span class="number">0</span>, <span class="number">3</span>);

middle = numbers.slice(<span class="number">3</span>, <span class="number">6</span>);

end = numbers.slice(<span class="number">6</span>);

copy = numbers.slice(<span class="number">0</span>);</code></pre><script>window.example14 = "numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nstart   = numbers[0..2]\n\nmiddle  = numbers[3...6]\n\nend     = numbers[6..]\n\ncopy    = numbers[..]\n\nalert middle"</script><div class='minibutton ok' onclick='var copy, end, middle, numbers, start;

numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9];

start = numbers.slice(0, 3);

middle = numbers.slice(3, 6);

end = numbers.slice(6);

copy = numbers.slice(0);;alert(middle);'>run: middle</div><br class='clear' /></div>
    <p>
      The same syntax can be used with assignment to replace a segment of an array
      with new values, splicing it.
    </p>
    <div class='code'><pre><code class="coffeescript">numbers = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]

numbers[<span class="number">3.</span>.<span class="number">6</span>] = [-<span class="number">3</span>, -<span class="number">4</span>, -<span class="number">5</span>, -<span class="number">6</span>]</code></pre><pre><code class="javascript"><span class="keyword">var</span> numbers, _ref;

numbers = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>];

[].splice.apply(numbers, [<span class="number">3</span>, <span class="number">4</span>].concat(_ref = [-<span class="number">3</span>, -<span class="number">4</span>, -<span class="number">5</span>, -<span class="number">6</span>])), _ref;</code></pre><script>window.example15 = "numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\nnumbers[3..6] = [-3, -4, -5, -6]\n\nalert numbers"</script><div class='minibutton ok' onclick='var numbers, _ref;

numbers = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];

[].splice.apply(numbers, [3, 4].concat(_ref = [-3, -4, -5, -6])), _ref;;alert(numbers);'>run: numbers</div><br class='clear' /></div>
    <p>
      Note that JavaScript strings are immutable, and can't be spliced.
    </p>
    <p>
      <span id="expressions" class="bookmark"></span>
      <b class="header">Everything is an Expression (at least, as much as possible)</b>
      You might have noticed how even though we don't add return statements
      to CoffeeScript functions, they nonetheless return their final value.
      The CoffeeScript compiler tries to make sure that all statements in the
      language can be used as expressions. Watch how the <tt>return</tt> gets
      pushed down into each possible branch of execution in the function
      below.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="function"><span class="title">grade</span></span> = (student) ->
  <span class="keyword">if</span> student.excellentWork
    <span class="string">"A+"</span>
  <span class="keyword">else</span> <span class="keyword">if</span> student.okayStuff
    <span class="keyword">if</span> student.triedHard then <span class="string">"B"</span> <span class="keyword">else</span> <span class="string">"B-"</span>
  <span class="keyword">else</span>
    <span class="string">"C"</span>

eldest = <span class="keyword">if</span> <span class="number">24</span> > <span class="number">21</span> then <span class="string">"Liz"</span> <span class="keyword">else</span> <span class="string">"Ike"</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> eldest, grade;

grade = <span class="keyword">function</span>(student) {
  <span class="keyword">if</span> (student.excellentWork) {
    <span class="keyword">return</span> <span class="string">"A+"</span>;
  } <span class="keyword">else</span> <span class="keyword">if</span> (student.okayStuff) {
    <span class="keyword">if</span> (student.triedHard) {
      <span class="keyword">return</span> <span class="string">"B"</span>;
    } <span class="keyword">else</span> {
      <span class="keyword">return</span> <span class="string">"B-"</span>;
    }
  } <span class="keyword">else</span> {
    <span class="keyword">return</span> <span class="string">"C"</span>;
  }
};

eldest = <span class="number">24</span> > <span class="number">21</span> ? <span class="string">"Liz"</span> : <span class="string">"Ike"</span>;</code></pre><script>window.example16 = "grade = (student) ->\n  if student.excellentWork\n    \"A+\"\n  else if student.okayStuff\n    if student.triedHard then \"B\" else \"B-\"\n  else\n    \"C\"\n\neldest = if 24 > 21 then \"Liz\" else \"Ike\"\n\nalert eldest"</script><div class='minibutton ok' onclick='var eldest, grade;

grade = function(student) {
  if (student.excellentWork) {
    return "A+";
  } else if (student.okayStuff) {
    if (student.triedHard) {
      return "B";
    } else {
      return "B-";
    }
  } else {
    return "C";
  }
};

eldest = 24 > 21 ? "Liz" : "Ike";;alert(eldest);'>run: eldest</div><br class='clear' /></div>
    <p>
      Even though functions will always return their final value, it's both possible
      and encouraged to return early from a function body writing out the explicit
      return (<tt>return value</tt>), when you know that you're done.
    </p>
    <p>
      Because variable declarations occur at the top of scope, assignment can
      be used within expressions, even for variables that haven't been seen before:
    </p>
    <div class='code'><pre><code class="coffeescript">six = (one = <span class="number">1</span>) + (two = <span class="number">2</span>) + (three = <span class="number">3</span>)</code></pre><pre><code class="javascript"><span class="keyword">var</span> one, six, three, two;

six = (one = <span class="number">1</span>) + (two = <span class="number">2</span>) + (three = <span class="number">3</span>);</code></pre><script>window.example17 = "six = (one = 1) + (two = 2) + (three = 3)\n\nalert six"</script><div class='minibutton ok' onclick='var one, six, three, two;

six = (one = 1) + (two = 2) + (three = 3);;alert(six);'>run: six</div><br class='clear' /></div>
    <p>
      Things that would otherwise be statements in JavaScript, when used
      as part of an expression in CoffeeScript, are converted into expressions
      by wrapping them in a closure. This lets you do useful things, like assign
      the result of a comprehension to a variable:
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="comment"># The first ten global properties.</span>

globals = (name <span class="keyword">for</span> name <span class="keyword">of</span> window)[<span class="number">0.</span>..<span class="number">10</span>]</code></pre><pre><code class="javascript"><span class="keyword">var</span> globals, name;

globals = ((<span class="keyword">function</span>() {
  <span class="keyword">var</span> _results;
  _results = [];
  <span class="keyword">for</span> (name <span class="keyword">in</span> window) {
    _results.push(name);
  }
  <span class="keyword">return</span> _results;
})()).slice(<span class="number">0</span>, <span class="number">10</span>);</code></pre><script>window.example18 = "# The first ten global properties.\n\nglobals = (name for name of window)[0...10]\n\nalert globals"</script><div class='minibutton ok' onclick='var globals, name;

globals = ((function() {
  var _results;
  _results = [];
  for (name in window) {
    _results.push(name);
  }
  return _results;
})()).slice(0, 10);;alert(globals);'>run: globals</div><br class='clear' /></div>
    <p>
      As well as silly things, like passing a <b>try/catch</b> statement directly
      into a function call:
    </p>
    <div class='code'><pre><code class="coffeescript">alert(
  <span class="keyword">try</span>
    nonexistent / <span class="literal">undefined</span>
  <span class="keyword">catch</span> error
    <span class="string">"And the error is ... <span class="subst">#{error}</span>"</span>
)</code></pre><pre><code class="javascript">alert((<span class="keyword">function</span>() {
  <span class="keyword">try</span> {
    <span class="keyword">return</span> nonexistent / <span class="keyword">void</span> <span class="number">0</span>;
  } <span class="keyword">catch</span> (error) {
    <span class="keyword">return</span> <span class="string">"And the error is ... "</span> + error;
  }
})());</code></pre><script>window.example19 = "alert(\n  try\n    nonexistent / undefined\n  catch error\n    \"And the error is ... #{error}\"\n)"</script><div class='minibutton ok' onclick='alert((function() {
  try {
    return nonexistent / void 0;
  } catch (error) {
    return "And the error is ... " + error;
  }
})());;'>run</div><br class='clear' /></div>
    <p>
      There are a handful of statements in JavaScript that can't be meaningfully
      converted into expressions, namely <tt>break</tt>, <tt>continue</tt>,
      and <tt>return</tt>. If you make use of them within a block of code,
      CoffeeScript won't try to perform the conversion.
    </p>

    <p>
      <span id="operators" class="bookmark"></span>
      <b class="header">Operators and Aliases</b>
      Because the <tt>==</tt> operator frequently causes undesirable coercion,
      is intransitive, and has a different meaning than in other languages,
      CoffeeScript compiles <tt>==</tt> into <tt>===</tt>, and <tt>!=</tt> into
      <tt>!==</tt>.
      In addition, <tt>is</tt> compiles into <tt>===</tt>,
      and <tt>isnt</tt> into <tt>!==</tt>.
    </p>
    <p>
      You can use <tt>not</tt> as an alias for <tt>!</tt>.
    </p>
    <p>
      For logic, <tt>and</tt> compiles to <tt>&amp;&amp;</tt>, and <tt>or</tt>
      into <tt>||</tt>.
    </p>
    <p>
      Instead of a newline or semicolon, <tt>then</tt> can be used to separate
      conditions from expressions, in <b>while</b>,
      <b>if</b>/<b>else</b>, and <b>switch</b>/<b>when</b> statements.
    </p>
    <p>
      As in <a href="http://yaml.org/">YAML</a>, <tt>on</tt> and <tt>yes</tt>
      are the same as boolean <tt>true</tt>, while <tt>off</tt> and <tt>no</tt> are boolean <tt>false</tt>.
    </p>
    <p>
      <tt>unless</tt> can be used as the inverse of <tt>if</tt>.
    </p>
    <p>
      As a shortcut for <tt>this.property</tt>, you can use <tt>@property</tt>.
    </p>
    <p>
      You can use <tt>in</tt> to test for array presence, and <tt>of</tt> to
      test for JavaScript object-key presence.
    </p>

    <p>
      All together now:
    </p>

    <table class="definitions">
      <tr><th>CoffeeScript</th><th>JavaScript</th></tr>
      <tr><td><tt>is</tt></td><td><tt>===</tt></td></tr>
      <tr><td><tt>isnt</tt></td><td><tt>!==</tt></td></tr>
      <tr><td><tt>not</tt></td><td><tt>!</tt></td></tr>
      <tr><td><tt>and</tt></td><td><tt>&amp;&amp;</tt></td></tr>
      <tr><td><tt>or</tt></td><td><tt>||</tt></td></tr>
      <tr><td><tt>true, yes, on</tt></td><td><tt>true</tt></td></tr>
      <tr><td><tt>false, no, off</tt></td><td><tt>false</tt></td></tr>
      <tr><td><tt>@, this</tt></td><td><tt>this</tt></td></tr>
      <tr><td><tt>of</tt></td><td><tt>in</tt></td></tr>
      <tr><td><tt>in</tt></td><td><i><small>no JS equivalent</small></i></td></tr>
    </table>

    <div class='code'><pre><code class="coffeescript">launch() <span class="keyword">if</span> ignition <span class="keyword">is</span> <span class="literal">on</span>

volume = <span class="number">10</span> <span class="keyword">if</span> band <span class="keyword">isnt</span> SpinalTap

letTheWildRumpusBegin() <span class="keyword">unless</span> answer <span class="keyword">is</span> <span class="literal">no</span>

<span class="keyword">if</span> car.speed &lt; limit then accelerate()

winner = <span class="literal">yes</span> <span class="keyword">if</span> pick <span class="keyword">in</span> [<span class="number">47</span>, <span class="number">92</span>, <span class="number">13</span>]

print inspect <span class="string">"My name is <span class="subst">#{@name}</span>"</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> volume, winner;

<span class="keyword">if</span> (ignition === <span class="literal">true</span>) {
  launch();
}

<span class="keyword">if</span> (band !== SpinalTap) {
  volume = <span class="number">10</span>;
}

<span class="keyword">if</span> (answer !== <span class="literal">false</span>) {
  letTheWildRumpusBegin();
}

<span class="keyword">if</span> (car.speed &lt; limit) {
  accelerate();
}

<span class="keyword">if</span> (pick === <span class="number">47</span> || pick === <span class="number">92</span> || pick === <span class="number">13</span>) {
  winner = <span class="literal">true</span>;
}

print(inspect(<span class="string">"My name is "</span> + <span class="keyword">this</span>.name));</code></pre><script>window.example20 = "launch() if ignition is on\n\nvolume = 10 if band isnt SpinalTap\n\nletTheWildRumpusBegin() unless answer is no\n\nif car.speed < limit then accelerate()\n\nwinner = yes if pick in [47, 92, 13]\n\nprint inspect \"My name is #{@name}\""</script><br class='clear' /></div>

    <p>
      <b class="header">The Existential Operator</b>
      It's a little difficult to check for the existence of a variable in
      JavaScript. <tt>if (variable) ...</tt> comes close, but fails for zero,
      the empty string, and false. CoffeeScript's existential operator <tt>?</tt> returns true unless
      a variable is <b>null</b> or <b>undefined</b>, which makes it analogous
      to Ruby's <tt>nil?</tt>
    </p>
    <p>
      It can also be used for safer conditional assignment than <tt>||=</tt>
      provides, for cases where you may be handling numbers or strings.
    </p>
    <div class='code'><pre><code class="coffeescript">solipsism = <span class="literal">true</span> <span class="keyword">if</span> mind? <span class="keyword">and</span> <span class="keyword">not</span> world?

speed = <span class="number">0</span>
speed ?= <span class="number">15</span>

footprints = yeti ? <span class="string">"bear"</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> footprints, solipsism, speed;

<span class="keyword">if</span> ((<span class="keyword">typeof</span> mind !== <span class="string">"undefined"</span> &amp;&amp; mind !== <span class="literal">null</span>) &amp;&amp; !(<span class="keyword">typeof</span> world !== <span class="string">"undefined"</span> &amp;&amp; world !== <span class="literal">null</span>)) {
  solipsism = <span class="literal">true</span>;
}

speed = <span class="number">0</span>;

<span class="keyword">if</span> (speed == <span class="literal">null</span>) {
  speed = <span class="number">15</span>;
}

footprints = <span class="keyword">typeof</span> yeti !== <span class="string">"undefined"</span> &amp;&amp; yeti !== <span class="literal">null</span> ? yeti : <span class="string">"bear"</span>;</code></pre><script>window.example21 = "solipsism = true if mind? and not world?\n\nspeed = 0\nspeed ?= 15\n\nfootprints = yeti ? \"bear\"\n\nalert footprints"</script><div class='minibutton ok' onclick='var footprints, solipsism, speed;

if ((typeof mind !== "undefined" && mind !== null) && !(typeof world !== "undefined" && world !== null)) {
  solipsism = true;
}

speed = 0;

if (speed == null) {
  speed = 15;
}

footprints = typeof yeti !== "undefined" && yeti !== null ? yeti : "bear";;alert(footprints);'>run: footprints</div><br class='clear' /></div>
    <p>
      The accessor variant of the existential operator <tt>?.</tt> can be used to soak
      up null references in a chain of properties. Use it instead
      of the dot accessor <tt>.</tt> in cases where the base value may be <b>null</b>
      or <b>undefined</b>. If all of the properties exist then you'll get the expected
      result, if the chain is broken, <b>undefined</b> is returned instead of
      the <b>TypeError</b> that would be raised otherwise.
    </p>
    <div class='code'><pre><code class="coffeescript">zip = lottery.drawWinner?().address?.zipcode</code></pre><pre><code class="javascript"><span class="keyword">var</span> zip, _ref;

zip = <span class="keyword">typeof</span> lottery.drawWinner === <span class="string">"function"</span> ? (_ref = lottery.drawWinner().address) != <span class="literal">null</span> ? _ref.zipcode : <span class="keyword">void</span> <span class="number">0</span> : <span class="keyword">void</span> <span class="number">0</span>;</code></pre><script>window.example22 = "zip = lottery.drawWinner?().address?.zipcode"</script><br class='clear' /></div>
    <p>
      Soaking up nulls is similar to Ruby's
      <a href="http://andand.rubyforge.org/">andand gem</a>, and to the
      <a href="http://groovy.codehaus.org/Operators#Operators-SafeNavigationOperator%28%3F.%29">safe navigation operator</a>
      in Groovy.
    </p>

    <p>
      <span id="classes" class="bookmark"></span>
      <b class="header">Classes, Inheritance, and Super</b>
      JavaScript's prototypal inheritance has always been a bit of a
      brain-bender, with a whole family tree of libraries that provide a cleaner
      syntax for classical inheritance on top of JavaScript's prototypes:
      <a href="http://code.google.com/p/base2/">Base2</a>,
      <a href="http://prototypejs.org/">Prototype.js</a>,
      <a href="http://jsclass.jcoglan.com/">JS.Class</a>, etc.
      The libraries provide syntactic sugar, but the built-in inheritance would
      be completely usable if it weren't for a couple of small exceptions:
      it's awkward to call <b>super</b> (the prototype object's
      implementation of the current function), and it's awkward to correctly
      set the prototype chain.
    </p>
    <p>
      Instead of repetitively attaching functions to a prototype, CoffeeScript
      provides a basic <tt>class</tt> structure that allows you to name your class,
      set the superclass, assign prototypal properties, and define the constructor,
      in a single assignable expression.
    </p>
    <p>
      Constructor functions are named, to better support helpful stack traces.
      In the first class in the example below, <tt>this.constructor.name is "Animal"</tt>.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="keyword">class</span> Animal
  constructor: (@name) ->

  move: (meters) ->
    alert @name + <span class="string">" moved <span class="subst">#{meters}</span>m."</span>

<span class="keyword">class</span> Snake <span class="keyword">extends</span> Animal
  move: ->
    alert <span class="string">"Slithering..."</span>
    super <span class="number">5</span>

<span class="keyword">class</span> Horse <span class="keyword">extends</span> Animal
  move: ->
    alert <span class="string">"Galloping..."</span>
    super <span class="number">45</span>

sam = <span class="keyword">new</span> Snake <span class="string">"Sammy the Python"</span>
tom = <span class="keyword">new</span> Horse <span class="string">"Tommy the Palomino"</span>

sam.move()
tom.move()</code></pre><pre><code class="javascript"><span class="keyword">var</span> Animal, Horse, Snake, sam, tom,
  __hasProp = {}.hasOwnProperty,
  __extends = <span class="keyword">function</span>(child, parent) { <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> parent) { <span class="keyword">if</span> (__hasProp.call(parent, key)) child[key] = parent[key]; } <span class="function"><span class="keyword">function</span> <span class="title">ctor</span><span class="params">()</span> {</span> <span class="keyword">this</span>.constructor = child; } ctor.prototype = parent.prototype; child.prototype = <span class="keyword">new</span> ctor(); child.__super__ = parent.prototype; <span class="keyword">return</span> child; };

Animal = (<span class="keyword">function</span>() {

  <span class="function"><span class="keyword">function</span> <span class="title">Animal</span><span class="params">(name)</span> {</span>
    <span class="keyword">this</span>.name = name;
  }

  Animal.prototype.move = <span class="keyword">function</span>(meters) {
    <span class="keyword">return</span> alert(<span class="keyword">this</span>.name + (<span class="string">" moved "</span> + meters + <span class="string">"m."</span>));
  };

  <span class="keyword">return</span> Animal;
})();

Snake = (<span class="keyword">function</span>(_super) {

  __extends(Snake, _super);

  <span class="function"><span class="keyword">function</span> <span class="title">Snake</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> Snake.__super__.constructor.apply(<span class="keyword">this</span>, arguments);
  }

  Snake.prototype.move = <span class="keyword">function</span>() {
    alert(<span class="string">"Slithering..."</span>);
    <span class="keyword">return</span> Snake.__super__.move.call(<span class="keyword">this</span>, <span class="number">5</span>);
  };

  <span class="keyword">return</span> Snake;
})(Animal);

Horse = (<span class="keyword">function</span>(_super) {

  __extends(Horse, _super);

  <span class="function"><span class="keyword">function</span> <span class="title">Horse</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> Horse.__super__.constructor.apply(<span class="keyword">this</span>, arguments);
  }

  Horse.prototype.move = <span class="keyword">function</span>() {
    alert(<span class="string">"Galloping..."</span>);
    <span class="keyword">return</span> Horse.__super__.move.call(<span class="keyword">this</span>, <span class="number">45</span>);
  };

  <span class="keyword">return</span> Horse;
})(Animal);

sam = <span class="keyword">new</span> Snake(<span class="string">"Sammy the Python"</span>);

tom = <span class="keyword">new</span> Horse(<span class="string">"Tommy the Palomino"</span>);

sam.move();

tom.move();</code></pre><script>window.example23 = "class Animal\n  constructor: (@name) ->\n\n  move: (meters) ->\n    alert @name + \" moved #{meters}m.\"\n\nclass Snake extends Animal\n  move: ->\n    alert \"Slithering...\"\n    super 5\n\nclass Horse extends Animal\n  move: ->\n    alert \"Galloping...\"\n    super 45\n\nsam = new Snake \"Sammy the Python\"\ntom = new Horse \"Tommy the Palomino\"\n\nsam.move()\ntom.move()"</script><div class='minibutton ok' onclick='var Animal, Horse, Snake, sam, tom,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Animal = (function() {

  function Animal(name) {
    this.name = name;
  }

  Animal.prototype.move = function(meters) {
    return alert(this.name + (" moved " + meters + "m."));
  };

  return Animal;
})();

Snake = (function(_super) {

  __extends(Snake, _super);

  function Snake() {
    return Snake.__super__.constructor.apply(this, arguments);
  }

  Snake.prototype.move = function() {
    alert("Slithering...");
    return Snake.__super__.move.call(this, 5);
  };

  return Snake;
})(Animal);

Horse = (function(_super) {

  __extends(Horse, _super);

  function Horse() {
    return Horse.__super__.constructor.apply(this, arguments);
  }

  Horse.prototype.move = function() {
    alert("Galloping...");
    return Horse.__super__.move.call(this, 45);
  };

  return Horse;
})(Animal);

sam = new Snake("Sammy the Python");

tom = new Horse("Tommy the Palomino");

sam.move();

tom.move();;'>run</div><br class='clear' /></div>
    <p>
      If structuring your prototypes classically isn't your cup of tea, CoffeeScript
      provides a couple of lower-level conveniences. The <tt>extends</tt> operator
      helps with proper prototype setup, and can be used to create an inheritance
      chain between any pair of constructor functions; <tt>::</tt> gives you
      quick access to an object's prototype; and <tt>super()</tt>
      is converted into a call against the immediate ancestor's method of the same name.
    </p>
    <div class='code'><pre><code class="coffeescript">String::<span class="function"><span class="title">dasherize</span></span> = ->
  <span class="keyword">this</span>.replace /_/g, <span class="string">"-"</span></code></pre><pre><code class="javascript">String.prototype.dasherize = <span class="keyword">function</span>() {
  <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/_/g</span>, <span class="string">"-"</span>);
};</code></pre><script>window.example24 = "String::dasherize = ->\n  this.replace /_/g, \"-\"\n\nalert \"one_two\".dasherize()"</script><div class='minibutton ok' onclick='String.prototype.dasherize = function() {
  return this.replace(/_/g, "-");
};;alert("one_two".dasherize());'>run: "one_two".dasherize()</div><br class='clear' /></div>
    <p>
      Finally, class definitions are blocks of executable code, which make for interesting
      metaprogramming possibilities. Because in the context of a class definition,
      <tt>this</tt> is the class object itself (the constructor function), you
      can assign static properties by using <br /><tt>@property: value</tt>, and call
      functions defined in parent classes: <tt>@attr 'title', type: 'text'</tt>
    </p>

    <p>
      <span id="destructuring" class="bookmark"></span>
      <b class="header">Destructuring Assignment</b>
      To make extracting values from complex arrays and objects more convenient,
      CoffeeScript implements ECMAScript Harmony's proposed
      <a href="http://wiki.ecmascript.org/doku.php?id=harmony:destructuring">destructuring assignment</a>
      syntax. When you assign an array or object literal to a value, CoffeeScript
      breaks up and matches both sides against each other, assigning the values
      on the right to the variables on the left. In the simplest case, it can be
      used for parallel assignment:
    </p>
    <div class='code'><pre><code class="coffeescript">theBait   = <span class="number">1000</span>
theSwitch = <span class="number">0</span>

[theBait, theSwitch] = [theSwitch, theBait]</code></pre><pre><code class="javascript"><span class="keyword">var</span> theBait, theSwitch, _ref;

theBait = <span class="number">1000</span>;

theSwitch = <span class="number">0</span>;

_ref = [theSwitch, theBait], theBait = _ref[<span class="number">0</span>], theSwitch = _ref[<span class="number">1</span>];</code></pre><script>window.example25 = "theBait   = 1000\ntheSwitch = 0\n\n[theBait, theSwitch] = [theSwitch, theBait]\n\nalert theBait"</script><div class='minibutton ok' onclick='var theBait, theSwitch, _ref;

theBait = 1000;

theSwitch = 0;

_ref = [theSwitch, theBait], theBait = _ref[0], theSwitch = _ref[1];;alert(theBait);'>run: theBait</div><br class='clear' /></div>
    <p>
      But it's also helpful for dealing with functions that return multiple
      values.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="function"><span class="title">weatherReport</span></span> = (location) ->
  <span class="comment"># Make an Ajax request to fetch the weather...</span>
  [location, <span class="number">72</span>, <span class="string">"Mostly Sunny"</span>]

[city, temp, forecast] = weatherReport <span class="string">"Berkeley, CA"</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> city, forecast, temp, weatherReport, _ref;

weatherReport = <span class="keyword">function</span>(location) {
  <span class="keyword">return</span> [location, <span class="number">72</span>, <span class="string">"Mostly Sunny"</span>];
};

_ref = weatherReport(<span class="string">"Berkeley, CA"</span>), city = _ref[<span class="number">0</span>], temp = _ref[<span class="number">1</span>], forecast = _ref[<span class="number">2</span>];</code></pre><script>window.example26 = "weatherReport = (location) ->\n  # Make an Ajax request to fetch the weather...\n  [location, 72, \"Mostly Sunny\"]\n\n[city, temp, forecast] = weatherReport \"Berkeley, CA\"\n\nalert forecast"</script><div class='minibutton ok' onclick='var city, forecast, temp, weatherReport, _ref;

weatherReport = function(location) {
  return [location, 72, "Mostly Sunny"];
};

_ref = weatherReport("Berkeley, CA"), city = _ref[0], temp = _ref[1], forecast = _ref[2];;alert(forecast);'>run: forecast</div><br class='clear' /></div>
    <p>
      Destructuring assignment can be used with any depth of array and object nesting,
      to help pull out deeply nested properties.
    </p>
    <div class='code'><pre><code class="coffeescript">futurists =
  sculptor: <span class="string">"Umberto Boccioni"</span>
  painter:  <span class="string">"Vladimir Burliuk"</span>
  poet:
    name:   <span class="string">"F.T. Marinetti"</span>
    address: [
      <span class="string">"Via Roma 42R"</span>
      <span class="string">"Bellagio, Italy 22021"</span>
    ]

{poet: {name, address: [street, city]}} = futurists</code></pre><pre><code class="javascript"><span class="keyword">var</span> city, futurists, name, street, _ref, _ref1;

futurists = {
  sculptor: <span class="string">"Umberto Boccioni"</span>,
  painter: <span class="string">"Vladimir Burliuk"</span>,
  poet: {
    name: <span class="string">"F.T. Marinetti"</span>,
    address: [<span class="string">"Via Roma 42R"</span>, <span class="string">"Bellagio, Italy 22021"</span>]
  }
};

_ref = futurists.poet, name = _ref.name, (_ref1 = _ref.address, street = _ref1[<span class="number">0</span>], city = _ref1[<span class="number">1</span>]);</code></pre><script>window.example27 = "futurists =\n  sculptor: \"Umberto Boccioni\"\n  painter:  \"Vladimir Burliuk\"\n  poet:\n    name:   \"F.T. Marinetti\"\n    address: [\n      \"Via Roma 42R\"\n      \"Bellagio, Italy 22021\"\n    ]\n\n{poet: {name, address: [street, city]}} = futurists\n\nalert name + \"  \" + street"</script><div class='minibutton ok' onclick='var city, futurists, name, street, _ref, _ref1;

futurists = {
  sculptor: "Umberto Boccioni",
  painter: "Vladimir Burliuk",
  poet: {
    name: "F.T. Marinetti",
    address: ["Via Roma 42R", "Bellagio, Italy 22021"]
  }
};

_ref = futurists.poet, name = _ref.name, (_ref1 = _ref.address, street = _ref1[0], city = _ref1[1]);;alert(name + "  " + street);'>run: name + "  " + street</div><br class='clear' /></div>
    <p>
      Destructuring assignment can even be combined with splats.
    </p>
    <div class='code'><pre><code class="coffeescript">tag = <span class="string">"&lt;impossible>"</span>

[open, contents..., close] = tag.split(<span class="string">""</span>)</code></pre><pre><code class="javascript"><span class="keyword">var</span> close, contents, open, tag, _i, _ref,
  __slice = [].slice;

tag = <span class="string">"&lt;impossible>"</span>;

_ref = tag.split(<span class="string">""</span>), open = _ref[<span class="number">0</span>], contents = <span class="number">3</span> &lt;= _ref.length ? __slice.call(_ref, <span class="number">1</span>, _i = _ref.length - <span class="number">1</span>) : (_i = <span class="number">1</span>, []), close = _ref[_i++];</code></pre><script>window.example28 = "tag = \"<impossible>\"\n\n[open, contents..., close] = tag.split(\"\")\n\nalert contents.join(\"\")"</script><div class='minibutton ok' onclick='var close, contents, open, tag, _i, _ref,
  __slice = [].slice;

tag = "<impossible>";

_ref = tag.split(""), open = _ref[0], contents = 3 <= _ref.length ? __slice.call(_ref, 1, _i = _ref.length - 1) : (_i = 1, []), close = _ref[_i++];;alert(contents.join(""));'>run: contents.join("")</div><br class='clear' /></div>

    <p>
      <span id="fat_arrow" class="bookmark"></span>
      <b class="header">Function binding</b>
      In JavaScript, the <tt>this</tt> keyword is dynamically scoped to mean the
      object that the current function is attached to. If you pass a function as
      a callback or attach it to a different object, the original value of <tt>this</tt>
      will be lost. If you're not familiar with this behavior,
      <a href="http://www.digital-web.com/articles/scope_in_javascript/">this Digital Web article</a>
      gives a good overview of the quirks.
    </p>
    <p>
      The fat arrow <tt>=&gt;</tt> can be used to both define a function, and to bind
      it to the current value of <tt>this</tt>, right on the spot. This is helpful
      when using callback-based libraries like Prototype or jQuery, for creating
      iterator functions to pass to <tt>each</tt>, or event-handler functions
      to use with <tt>bind</tt>. Functions created with the fat arrow are able to access
      properties of the <tt>this</tt> where they're defined.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="function"><span class="title">Account</span></span> = (customer, cart) ->
  @customer = customer
  @cart = cart

  $(<span class="string">'.shopping_cart'</span>).bind <span class="string">'click'</span>, (event) =>
    @customer.purchase @cart</code></pre><pre><code class="javascript"><span class="keyword">var</span> Account;

Account = <span class="keyword">function</span>(customer, cart) {
  <span class="keyword">var</span> _<span class="keyword">this</span> = <span class="keyword">this</span>;
  <span class="keyword">this</span>.customer = customer;
  <span class="keyword">this</span>.cart = cart;
  <span class="keyword">return</span> $(<span class="string">'.shopping_cart'</span>).bind(<span class="string">'click'</span>, <span class="keyword">function</span>(event) {
    <span class="keyword">return</span> _<span class="keyword">this</span>.customer.purchase(_<span class="keyword">this</span>.cart);
  });
};</code></pre><script>window.example29 = "Account = (customer, cart) ->\n  @customer = customer\n  @cart = cart\n\n  $('.shopping_cart').bind 'click', (event) =>\n    @customer.purchase @cart"</script><br class='clear' /></div>
    <p>
      If we had used <tt>-&gt;</tt> in the callback above, <tt>@customer</tt> would
      have referred to the undefined "customer" property of the DOM element,
      and trying to call <tt>purchase()</tt> on it would have raised an exception.
    </p>
    <p>
      When used in a class definition, methods declared with the fat arrow will
      be automatically bound to each instance of the class when the instance is
      constructed.
    </p>

    <p>
      <span id="embedded" class="bookmark"></span>
      <b class="header">Embedded JavaScript</b>
      Hopefully, you'll never need to use it, but if you ever need to intersperse
      snippets of JavaScript within your CoffeeScript, you can
      use backticks to pass it straight through.
    </p>
    <div class='code'><pre><code class="coffeescript">hi = `<span class="javascript"><span class="keyword">function</span>() {
  <span class="keyword">return</span> [document.title, <span class="string">"Hello JavaScript"</span>].join(<span class="string">": "</span>);
}</span>`</code></pre><pre><code class="javascript"><span class="keyword">var</span> hi;

hi = <span class="keyword">function</span>() {
  <span class="keyword">return</span> [document.title, <span class="string">"Hello JavaScript"</span>].join(<span class="string">": "</span>);
};</code></pre><script>window.example30 = "hi = `function() {\n  return [document.title, \"Hello JavaScript\"].join(\": \");\n}`\n\nalert hi()"</script><div class='minibutton ok' onclick='var hi;

hi = function() {
  return [document.title, "Hello JavaScript"].join(": ");
};;alert(hi());'>run: hi()</div><br class='clear' /></div>

    <p>
      <span id="switch" class="bookmark"></span>
      <b class="header">Switch/When/Else</b>
      <b>Switch</b> statements in JavaScript are a bit awkward. You need to
      remember to <b>break</b> at the end of every <b>case</b> statement to
      avoid accidentally falling through to the default case.
      CoffeeScript prevents accidental fall-through, and can convert the <tt>switch</tt>
      into a returnable, assignable expression. The format is: <tt>switch</tt> condition,
      <tt>when</tt> clauses, <tt>else</tt> the default case.
    </p>
    <p>
      As in Ruby, <b>switch</b> statements in CoffeeScript can take multiple
      values for each <b>when</b> clause. If any of the values match, the clause
      runs.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="keyword">switch</span> day
  <span class="keyword">when</span> <span class="string">"Mon"</span> then go work
  <span class="keyword">when</span> <span class="string">"Tue"</span> then go relax
  <span class="keyword">when</span> <span class="string">"Thu"</span> then go iceFishing
  <span class="keyword">when</span> <span class="string">"Fri"</span>, <span class="string">"Sat"</span>
    <span class="keyword">if</span> day <span class="keyword">is</span> bingoDay
      go bingo
      go dancing
  <span class="keyword">when</span> <span class="string">"Sun"</span> then go church
  <span class="keyword">else</span> go work</code></pre><pre><code class="javascript"><span class="keyword">switch</span> (day) {
  <span class="keyword">case</span> <span class="string">"Mon"</span>:
    go(work);
    <span class="keyword">break</span>;
  <span class="keyword">case</span> <span class="string">"Tue"</span>:
    go(relax);
    <span class="keyword">break</span>;
  <span class="keyword">case</span> <span class="string">"Thu"</span>:
    go(iceFishing);
    <span class="keyword">break</span>;
  <span class="keyword">case</span> <span class="string">"Fri"</span>:
  <span class="keyword">case</span> <span class="string">"Sat"</span>:
    <span class="keyword">if</span> (day === bingoDay) {
      go(bingo);
      go(dancing);
    }
    <span class="keyword">break</span>;
  <span class="keyword">case</span> <span class="string">"Sun"</span>:
    go(church);
    <span class="keyword">break</span>;
  <span class="keyword">default</span>:
    go(work);
}</code></pre><script>window.example31 = "switch day\n  when \"Mon\" then go work\n  when \"Tue\" then go relax\n  when \"Thu\" then go iceFishing\n  when \"Fri\", \"Sat\"\n    if day is bingoDay\n      go bingo\n      go dancing\n  when \"Sun\" then go church\n  else go work"</script><br class='clear' /></div>

    <p>
      <span id="try" class="bookmark"></span>
      <b class="header">Try/Catch/Finally</b>
      Try/catch statements are just about the same as JavaScript (although
      they work as expressions).
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="keyword">try</span>
  allHellBreaksLoose()
  catsAndDogsLivingTogether()
<span class="keyword">catch</span> error
  print error
<span class="keyword">finally</span>
  cleanUp()</code></pre><pre><code class="javascript"><span class="keyword">try</span> {
  allHellBreaksLoose();
  catsAndDogsLivingTogether();
} <span class="keyword">catch</span> (error) {
  print(error);
} <span class="keyword">finally</span> {
  cleanUp();
}</code></pre><script>window.example32 = "try\n  allHellBreaksLoose()\n  catsAndDogsLivingTogether()\ncatch error\n  print error\nfinally\n  cleanUp()"</script><br class='clear' /></div>

    <p>
      <span id="comparisons" class="bookmark"></span>
      <b class="header">Chained Comparisons</b>
      CoffeeScript borrows
      <a href="http://docs.python.org/reference/expressions.html#notin">chained comparisons</a>
      from Python &mdash; making it easy to test if a value falls within a
      certain range.
    </p>
    <div class='code'><pre><code class="coffeescript">cholesterol = <span class="number">127</span>

healthy = <span class="number">200</span> > cholesterol > <span class="number">60</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> cholesterol, healthy;

cholesterol = <span class="number">127</span>;

healthy = (<span class="number">200</span> > cholesterol &amp;&amp; cholesterol > <span class="number">60</span>);</code></pre><script>window.example33 = "cholesterol = 127\n\nhealthy = 200 > cholesterol > 60\n\nalert healthy"</script><div class='minibutton ok' onclick='var cholesterol, healthy;

cholesterol = 127;

healthy = (200 > cholesterol && cholesterol > 60);;alert(healthy);'>run: healthy</div><br class='clear' /></div>

    <p>
      <span id="strings" class="bookmark"></span>
      <b class="header">String Interpolation, Block Strings, and Block Comments</b>
      Ruby-style string interpolation is included in CoffeeScript. Double-quoted
      strings allow for interpolated values, using <tt>#{ ... }</tt>,
      and single-quoted strings are literal.
    </p>
    <div class='code'><pre><code class="coffeescript">author = <span class="string">"Wittgenstein"</span>
quote  = <span class="string">"A picture is a fact. -- <span class="subst">#{ author }</span>"</span>

sentence = <span class="string">"<span class="subst">#{ <span class="number">22</span> / <span class="number">7</span> }</span> is a decent approximation of "</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> author, quote, sentence;

author = <span class="string">"Wittgenstein"</span>;

quote = <span class="string">"A picture is a fact. -- "</span> + author;

sentence = <span class="string">""</span> + (<span class="number">22</span> / <span class="number">7</span>) + <span class="string">" is a decent approximation of "</span>;</code></pre><script>window.example34 = "author = \"Wittgenstein\"\nquote  = \"A picture is a fact. -- #{ author }\"\n\nsentence = \"#{ 22 / 7 } is a decent approximation of \"\n\nalert sentence"</script><div class='minibutton ok' onclick='var author, quote, sentence;

author = "Wittgenstein";

quote = "A picture is a fact. -- " + author;

sentence = "" + (22 / 7) + " is a decent approximation of ";;alert(sentence);'>run: sentence</div><br class='clear' /></div>
    <p>
      Multiline strings are allowed in CoffeeScript.
    </p>
    <div class='code'><pre><code class="coffeescript">mobyDick = <span class="string">"Call me Ishmael. Some years ago --
 never mind how long precisely -- having little
 or no money in my purse, and nothing particular
 to interest me on shore, I thought I would sail
 about a little and see the watery part of the
 world..."</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> mobyDick;

mobyDick = <span class="string">"Call me Ishmael. Some years ago -- never mind how long precisely -- having little or no money in my purse, and nothing particular to interest me on shore, I thought I would sail about a little and see the watery part of the world..."</span>;</code></pre><script>window.example35 = "mobyDick = \"Call me Ishmael. Some years ago --\n never mind how long precisely -- having little\n or no money in my purse, and nothing particular\n to interest me on shore, I thought I would sail\n about a little and see the watery part of the\n world...\"\n\nalert mobyDick"</script><div class='minibutton ok' onclick='var mobyDick;

mobyDick = "Call me Ishmael. Some years ago -- never mind how long precisely -- having little or no money in my purse, and nothing particular to interest me on shore, I thought I would sail about a little and see the watery part of the world...";;alert(mobyDick);'>run: mobyDick</div><br class='clear' /></div>
    <p>
      Block strings can be used to hold formatted or indentation-sensitive text
      (or, if you just don't feel like escaping quotes and apostrophes). The
      indentation level that begins the block is maintained throughout, so
      you can keep it all aligned with the body of your code.
    </p>
    <div class='code'><pre><code class="coffeescript">html = <span class="string">"""
       &lt;strong>
         cup of coffeescript
       &lt;/strong>
       """</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> html;

html = <span class="string">"&lt;strong>\n  cup of coffeescript\n&lt;/strong>"</span>;</code></pre><script>window.example36 = "html = \"\"\"\n       <strong>\n         cup of coffeescript\n       </strong>\n       \"\"\"\n\nalert html"</script><div class='minibutton ok' onclick='var html;

html = "<strong>\n  cup of coffeescript\n</strong>";;alert(html);'>run: html</div><br class='clear' /></div>
    <p>
      Double-quoted block strings, like other double-quoted strings, allow interpolation.
    </p>
    <p>
      Sometimes you'd like to pass a block comment through to the generated
      JavaScript. For example, when you need to embed a licensing header at
      the top of a file. Block comments, which mirror the syntax for block strings,
      are preserved in the generated code.
    </p>
    <div class='code'><pre><code class="coffeescript"><span class="comment">###
Caffeine Compiler v0.2.4
Released under the MIT License
###</span></code></pre><pre><code class="javascript"><span class="comment">/*
Caffeine Compiler v0.2.4
Released under the MIT License
*/</span></code></pre><script>window.example37 = "###\nCaffeine Compiler v0.2.4\nReleased under the MIT License\n###"</script><br class='clear' /></div>

    <p>
      <span id="regexes" class="bookmark"></span>
      <b class="header">Block Regular Expressions</b>
      Similar to block strings and comments, CoffeeScript supports block regexes &mdash;
      extended regular expressions that ignore internal whitespace and can contain
      comments and interpolation. Modeled after Perl's <tt>/x</tt> modifier, CoffeeSctipt's
      block regexes are delimited by <tt>///</tt> and go a long way towards making complex
      regular expressions readable. To quote from the CoffeeScript source:
    </p>
    <div class='code'><pre><code class="coffeescript">OPERATOR = <span class="regexp">/// ^ (
  ?: [-=]>             <span class="comment"># function</span>
   | [-+*/%&lt;>&amp;|^!?=]=  <span class="comment"># compound assign / compare</span>
   | >>>=?             <span class="comment"># zero-fill right shift</span>
   | ([-+:])\1         <span class="comment"># doubles</span>
   | ([&amp;|&lt;>])\2=?      <span class="comment"># logic / shift</span>
   | \?\.              <span class="comment"># soak access</span>
   | \.{2,3}           <span class="comment"># range or splat</span>
) ///</span></code></pre><pre><code class="javascript"><span class="keyword">var</span> OPERATOR;

OPERATOR = <span class="regexp">/^(?:[-=]>|[-+*\/%&lt;>&amp;|^!?=]=|>>>=?|([-+:])\1|([&amp;|&lt;>])\2=?|\?\.|\.{2,3})/</span>;</code></pre><script>window.example38 = "OPERATOR = /// ^ (\n  ?: [-=]>             # function\n   | [-+*/%<>&|^!?=]=  # compound assign / compare\n   | >>>=?             # zero-fill right shift\n   | ([-+:])\\1         # doubles\n   | ([&|<>])\\2=?      # logic / shift\n   | \\?\\.              # soak access\n   | \\.{2,3}           # range or splat\n) ///"</script><br class='clear' /></div>


    <h2>
      <span id="cake" class="bookmark"></span>
      Cake, and Cakefiles
    </h2>

    <p>
      CoffeeScript includes a (very) simple build system similar to
      <a href="http://www.gnu.org/software/make/">Make</a> and
      <a href="http://rake.rubyforge.org/">Rake</a>. Naturally,
      it's called Cake, and is used for the tasks that build and test the CoffeeScript
      language itself. Tasks are defined in a file named <tt>Cakefile</tt>, and
      can be invoked by running <tt>cake [task]</tt> from within the directory.
      To print a list of all the tasks and options, just type <tt>cake</tt>.
    </p>

    <p>
      Task definitions are written in CoffeeScript, so you can put arbitrary code
      in your Cakefile. Define a task with a name, a long description, and the
      function to invoke when the task is run. If your task takes a command-line
      option, you can define the option with short and long flags, and it will
      be made available in the <tt>options</tt> object. Here's a task that uses
      the Node.js API to rebuild CoffeeScript's parser:
    </p>
    <div class='code'><pre><code class="coffeescript">fs = require <span class="string">'fs'</span>

option <span class="string">'-o'</span>, <span class="string">'--output [DIR]'</span>, <span class="string">'directory for compiled code'</span>

task <span class="string">'build:parser'</span>, <span class="string">'rebuild the Jison parser'</span>, (options) ->
  require <span class="string">'jison'</span>
  code = require(<span class="string">'./lib/grammar'</span>).parser.generate()
  dir  = options.output <span class="keyword">or</span> <span class="string">'lib'</span>
  fs.writeFile <span class="string">"<span class="subst">#{dir}</span>/parser.js"</span>, code</code></pre><pre><code class="javascript"><span class="keyword">var</span> fs;

fs = require(<span class="string">'fs'</span>);

option(<span class="string">'-o'</span>, <span class="string">'--output [DIR]'</span>, <span class="string">'directory for compiled code'</span>);

task(<span class="string">'build:parser'</span>, <span class="string">'rebuild the Jison parser'</span>, <span class="keyword">function</span>(options) {
  <span class="keyword">var</span> code, dir;
  require(<span class="string">'jison'</span>);
  code = require(<span class="string">'./lib/grammar'</span>).parser.generate();
  dir = options.output || <span class="string">'lib'</span>;
  <span class="keyword">return</span> fs.writeFile(<span class="string">""</span> + dir + <span class="string">"/parser.js"</span>, code);
});</code></pre><script>window.example39 = "fs = require 'fs'\n\noption '-o', '--output [DIR]', 'directory for compiled code'\n\ntask 'build:parser', 'rebuild the Jison parser', (options) ->\n  require 'jison'\n  code = require('./lib/grammar').parser.generate()\n  dir  = options.output or 'lib'\n  fs.writeFile \"#{dir}/parser.js\", code"</script><br class='clear' /></div>
    <p>
      If you need to invoke one task before another &mdash; for example, running
      <tt>build</tt> before <tt>test</tt>, you can use the <tt>invoke</tt> function:
      <tt>invoke 'build'</tt>. Cake tasks are a minimal way to expose your
      CoffeeScript functions to the command line, so
      <a href="documentation/docs/cake.html">don't expect any fanciness built-in</a>.
      If you need dependencies, or async callbacks, it's best to put them in your
      code itself &mdash; not the cake task.
    </p>

    <h2>
      <span id="scripts" class="bookmark"></span>
      "text/coffeescript" Script Tags
    </h2>

    <p>
      While it's not recommended for serious use, CoffeeScripts may be included
      directly within the browser using <tt>&lt;script type="text/coffeescript"&gt;</tt>
      tags. The source includes a compressed and minified version of the compiler
      (<a href="extras/caffeine.js">Download current version here, 39k when gzipped</a>)
      as <tt>extras/caffeine.js</tt>. Include this file on a page with
      inline CoffeeScript tags, and it will compile and evaluate them in order.
    </p>

    <p>
      In fact, the little bit of glue script that runs "Try CoffeeScript" above,
      as well as the jQuery for the menu, is implemented in just this way.
      View source and look at the bottom of the page to see the example.
      Including the script also gives you access to <tt>CoffeeScript.compile()</tt>
      so you can pop open Firebug and try compiling some strings.
    </p>

    <p>
      The usual caveats about CoffeeScript apply &mdash; your inline scripts will
      run within a closure wrapper, so if you want to expose global variables or
      functions, attach them to the <tt>window</tt> object.
    </p>

    <h2>
      <span id="resources" class="bookmark"></span>
      Books
    </h2>

    <p>
      There are a number of excellent resources to help you get
      started with CoffeeScript, some of which are freely available online.
    </p>

    <ul>
      <li>
        <a href="http://arcturo.github.com/library/coffeescript/">The Little Book on CoffeeScript</a>
        is a brief 5-chapter introduction to CoffeeScript, written with great
        clarity and precision by
        <a href="http://alexmaccaw.co.uk/">Alex MacCaw</a>.
      </li>
      <li>
        <a href="http://autotelicum.github.com/Smooth-CoffeeScript/">Smooth CoffeeScript</a>
        is a reimagination of the excellent book
        <a href="http://eloquentjavascript.net/">Eloquent JavaScript</a>, as if
        it had been written in CoffeeScript instead. Covers language features
        as well a the functional and object oriented programming styles. By
        <a href="https://github.com/autotelicum">E. Hoigaard</a>.
      </li>
      <li>
        <a href="http://pragprog.com/book/tbcoffee/coffeescript">CoffeeScript: Accelerated JavaScript Development</a>
        is <a href="http://trevorburnham.com/">Trevor Burnham</a>'s thorough
        introduction to the language. By the end of the book, you'll have built
        a fast-paced multiplayer word game, writing both the client-side and Node.js
        portions in CoffeeScript.
      </li>
    </ul>
    
    <h2>
      Screencasts
    </h2>
    
    <ul>
      <li>
        <a href="http://coffeescript.codeschool.com">A Sip of CoffeeScript</a> is a <a href="http://www.codeschool.com">Code School Course</a>
        which combines 6 screencasts with in-browser coding to make learning fun.  The first level is free to try out.
      </li>
      <li>
        <a href="http://peepcode.com/products/coffeescript">Meet CoffeeScript</a>
        is a 75-minute long screencast by <a href="http://peepcode.com/">PeepCode</a>.
        Highly memorable for its animations which demonstrate transforming CoffeeScript
        into the equivalent JS.
      </li>
      <li>
        If you're looking for less of a time commitment, RailsCasts'
        <a href="http://railscasts.com/episodes/267-coffeescript-basics">CoffeeScript Basics</a>
        should have you covered, hitting all of the important notes about CoffeeScript
        in 11 minutes.
      </li>
    </ul>

    <h2>
      Examples
    </h2>
    
    <p>
      The <a href="https://github.com/languages/coffeescript">best list of 
      open-source CoffeeScript examples</a> can be found on GitHub. But just
      to throw out few more:
    </p>

    <ul>
      <li>
        <b>github</b>'s <a href="http://hubot.github.com/">Hubot</a>,
        a friendly IRC robot that can perform any number of useful and useless tasks.
      </li>
      <li>
        <b>sstephenson</b>'s <a href="http://pow.cx/">Pow</a>,
        a zero-configuration Rack server, with comprehensive annotated source.
      </li>
      <li>
        <b>frank06</b>'s <a href="http://riakjs.org/">riak-js</a>, a Node.js client for
        <a href="http://www.basho.com/Riak.html">Riak</a>, with support for HTTP
        and Protocol Buffers.
      </li>
      <li>
        <b>technoweenie</b>'s <a href="https://github.com/technoweenie/coffee-resque">Coffee-Resque</a>,
        a port of <a href="https://github.com/defunkt/resque">Resque</a> for Node.js.
      </li>
      <li>
        <b>assaf</b>'s <a href="http://zombie.labnotes.org/">Zombie.js</a>,
        a headless, full-stack, faux-browser testing library for Node.js.
      </li>
      <li>
        <b>jashkenas</b>' <a href="documentation/docs/underscore.html">Underscore.coffee</a>, a port
        of the <a href="http://documentcloud.github.com/underscore/">Underscore.js</a>
        library of helper functions.
      </li>
      <li>
        <b>stephank</b>'s <a href="https://github.com/stephank/orona">Orona</a>, a remake of
        the Bolo tank game for modern browsers.
      </li>
      <li>
        <b>josh</b>'s <a href="http://josh.github.com/nack/">nack</a>, a Node.js-powered
        <a href="http://rack.rubyforge.org/">Rack</a> server.
      </li>
    </ul>

    <h2>
      Resources
    </h2>

    <ul>
      <li>
        <a href="http://github.com/jashkenas/coffee-script/">Source Code</a><br />
        Use <tt>bin/coffee</tt> to test your changes,<br />
        <tt>bin/cake test</tt> to run the test suite,<br />
        <tt>bin/cake build</tt> to rebuild the CoffeeScript compiler, and <br />
        <tt>bin/cake build:parser</tt> to regenerate the Jison parser if you're
        working on the grammar. <br /><br />
        <tt>git checkout lib &amp;&amp; bin/cake build:full</tt> is a good command to run when you're working
        on the core language. It'll refresh the lib directory
        (in case you broke something), build your altered compiler, use that to
        rebuild itself (a good sanity test) and then run all of the tests. If
        they pass, there's a good chance you've made a successful change.
      </li>
      <li>
        <a href="http://github.com/jashkenas/coffee-script/issues">CoffeeScript Issues</a><br />
        Bug reports, feature proposals, and ideas for changes to the language belong here.
      </li>
      <li>
        <a href="https://groups.google.com/forum/#!forum/coffeescript">CoffeeScript Google Group</a><br />
        If you'd like to ask a question, the mailing list is a good place to get help.
      </li>
      <li>
        <a href="http://github.com/jashkenas/coffee-script/wiki">The CoffeeScript Wiki</a><br />
        If you've ever learned a neat CoffeeScript tip or trick, or ran into a gotcha &mdash; share it on the wiki.
        The wiki also serves as a directory of handy
        <a href="http://github.com/jashkenas/coffee-script/wiki/Text-editor-plugins">text editor extensions</a>,
        <a href="http://github.com/jashkenas/coffee-script/wiki/Web-framework-plugins">web framework plugins</a>,
        and general <a href="http://github.com/jashkenas/coffee-script/wiki/Build-tools">CoffeeScript build tools</a>.
      </li>
      <li>
        <a href="http://github.com/jashkenas/coffee-script/wiki/FAQ">The FAQ</a><br />
        Perhaps your CoffeeScript-related question has been asked before. Check the FAQ first.
      </li>
      <li>
        <a href="https://github.com/jashkenas/coffee-script/downloads">High-Rez Logo</a><br />
        The CoffeeScript logo is available in Illustrator, EPS and PSD formats, for use
        in presentations.
      </li>
    </ul>

    <h2>
      <span id="webchat" class="bookmark"></span>
      Web Chat (IRC)
    </h2>

    <p>
      Quick help and advice can usually be found in the CoffeeScript IRC room.
      Join <tt>#coffeescript</tt> on <tt>irc.freenode.net</tt>, or click the
      button below to open a webchat session on this page.
    </p>

    <p>
      <button id="open_webchat">click to open #coffeescript</button>
    </p>

    <h2>
      <span id="changelog" class="bookmark"></span>
      Change Log
    </h2>
    
    <p>
      <b class="header" style="margin-top: 20px;">
        <a href="https://github.com/ich/caffeine/compare/0.2.4">0.2.4</a>
        <span class="timestamp"> &ndash; <small>Jul 28, 2012</small></span>
      </b>
    </p>

  </div>

  <script type="text/coffeescript">
    sourceFragment = "try:"

    # Set up the compilation function, to run when you stop typing.
    compileSource = ->
      source = $('#repl_source').val()
      window.compiledJS = ''
      try
        window.compiledJS = Caffeine.compile source, bare: on
        el = $('#repl_results')[0]
        if el.innerText
          el.innerText = window.compiledJS
        else
          $(el).text window.compiledJS
        $('#error').hide()
      catch error
        $('#error').text(error.message).show()

      # Update permalink
      $('#repl_permalink').attr 'href', "##{sourceFragment}#{encodeURIComponent source}"

    # Listen for keypresses and recompile.
    $('#repl_source').keyup -> compileSource()

    # Eval the compiled js.
    evalJS = ->
      try
        eval window.compiledJS
      catch error then alert error

    # Load the console with a string of CoffeeScript.
    window.loadConsole = (coffee) ->
      $('#repl_source').val coffee
      compileSource()
      $('.navigation.try').addClass('active')
      false

    # Helper to hide the menus.
    closeMenus = ->
      $('.navigation.active').removeClass 'active'

    $('.minibutton.run').click -> evalJS()

    # Bind navigation buttons to open the menus.
    $('.navigation').click (e) ->
      return if e.target.tagName.toLowerCase() is 'a'
      return false if $(e.target).closest('.repl_wrapper').length
      if $(this).hasClass('active')
        closeMenus()
      else
        closeMenus()
        $(this).addClass 'active'
      false

    # Dismiss console if Escape pressed or click falls outside console
    # Trigger Run button on Ctrl-Enter
    $(document.body)
      .keydown (e) ->
        closeMenus() if e.which == 27
        evalJS() if e.which == 13 and (e.metaKey or e.ctrlKey) and $('.minibutton.run:visible').length
      .click (e) ->
        return false if $(e.target).hasClass('minibutton')
        closeMenus()

    $('#open_webchat').click ->
      $(this).replaceWith $('<iframe src="http://webchat.freenode.net/?channels=coffeescript" width="625" height="400"></iframe>')

    $("#repl_permalink").click (e) ->
        window.location = $(this).attr("href")
        false

    # If source code is included in location.hash, display it.
    hash = decodeURIComponent location.hash.replace(/^#/, '')
    if hash.indexOf(sourceFragment) == 0
        src = hash.substr sourceFragment.length
        loadConsole src

    compileSource()

  </script>

  <script src="documentation/vendor/jquery-1.6.4.js"></script>
  <script src="extras/caffeine.js"></script>

</body>
</html>